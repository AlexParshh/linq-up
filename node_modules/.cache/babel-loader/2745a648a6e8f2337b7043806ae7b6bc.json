{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Alex\\\\linq-up\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Alex\\\\linq-up\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"C:\\\\Users\\\\Alex\\\\linq-up\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _toConsumableArray from\"C:\\\\Users\\\\Alex\\\\linq-up\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";import _createForOfIteratorHelper from\"C:\\\\Users\\\\Alex\\\\linq-up\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createForOfIteratorHelper\";import _classCallCheck from\"C:\\\\Users\\\\Alex\\\\linq-up\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Alex\\\\linq-up\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\Alex\\\\linq-up\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\Alex\\\\linq-up\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import PersonList from\"./PersonList\";import Person from\"./Person\";import fetch from\"cross-fetch\";import MapContainer from\"./Map\";import PlacePicker from\"./PlacePicker\";import DirectionsPicker from\"./DirectionsPicker\";import\"bootstrap/dist/css/bootstrap.css\";import\"./styles.css\";import Axios from\"axios\";import{Alert,Modal,ModalHeader,ModalBody,ModalFooter}from\"reactstrap\";var moment=require(\"moment\");var Application=/*#__PURE__*/function(_Component){_inherits(Application,_Component);var _super=_createSuper(Application);function Application(){var _this;_classCallCheck(this,Application);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={people:[/*#__PURE__*/React.createElement(Person,{key:\"1\",value:\"1\",onSetAddress:function onSetAddress(e,v){return _this.handleSetAddress(e,v);},onSetEmail:function onSetEmail(e,v){return _this.handleSetEmail(e,v);}}),/*#__PURE__*/React.createElement(Person,{key:\"2\",value:\"2\",onSetAddress:function onSetAddress(e,v){return _this.handleSetAddress(e,v);},onSetEmail:function onSetEmail(e,v){return _this.handleSetEmail(e,v);}}),/*#__PURE__*/React.createElement(Person,{key:\"3\",value:\"3\",onSetAddress:function onSetAddress(e,v){return _this.handleSetAddress(e,v);},onSetEmail:function onSetEmail(e,v){return _this.handleSetEmail(e,v);}})],addresses:[\"\",\"\",\"\"],coords:[],midPoint:\"\",currentLocation:[],POI:\"\",radius:\"300\",nearbyPlaces:{},transportOption:null,date:new Date(),meetupPoint:\"\",travelTimes:[],leaveTimes:[],emails:[\"\",\"\",\"\"],linqupbtnStyle:{display:\"none\"},modalVisibility:false,meetupPointName:\"\",circleLat:0,circleLng:0};_this.handleSetEmail=function(e,v){var newEmails=_this.state.emails.slice();newEmails[v-1]=e;_this.setState({emails:newEmails});};_this.handleSetAddress=function(e,v){var newAddresses=_this.state.addresses.slice();newAddresses[v-1]=e;_this.setState({addresses:newAddresses});};_this.emptyChecker=function(){var a=_this.state.addresses;var _iterator=_createForOfIteratorHelper(a),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var i=_step.value;if(i===\"\"){return true;}}}catch(err){_iterator.e(err);}finally{_iterator.f();}return false;};_this.handleAddPerson=function(){_this.resetMidPoint();var newEmails=[].concat(_toConsumableArray(_this.state.emails),[\"\"]);var newAddresses=[].concat(_toConsumableArray(_this.state.addresses),[\"\"]);_this.setState({addresses:newAddresses,leaveTimes:[],meetupPoint:null,travelTimes:[],nearbyPlaces:{},emails:newEmails,circleLat:0,circleLng:0,coords:[]});_this.setState({people:[].concat(_toConsumableArray(_this.state.people),[/*#__PURE__*/React.createElement(Person,{key:_this.state.people.length+1,value:_this.state.people.length+1,onSetAddress:function onSetAddress(e,v){return _this.handleSetAddress(e,v);},onSetEmail:function onSetEmail(e,v){return _this.handleSetEmail(e,v);}})])});};_this.handleDeletePerson=function(){var newcoords=_this.state.coords.slice(0,-1);_this.setState(_defineProperty({coords:newcoords,leaveTimes:[],meetupPoint:null,travelTimes:[],nearbyPlaces:{},circleLat:0,circleLng:0},\"coords\",[]));_this.resetMidPoint();var newEmails=_this.state.emails.slice(0,-1);var newAddresses=_this.state.addresses.slice(0,-1);_this.setState({addresses:newAddresses,emails:newEmails});var people=_this.state.people.slice(0,-1);_this.setState({people:people});};_this.getCoords=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(address){var bod,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:bod={address:address};_context.next=3;return Axios.post(\"http://localhost:4000/geolocate\",bod);case 3:res=_context.sent;if(!(res.status!==200)){_context.next=6;break;}throw Error(res.body.message);case 6:return _context.abrupt(\"return\",res.data);case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.convertToCoords=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var all,newCoords,a,i;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:all=_this.state.addresses;newCoords=[];i=0;case 3:if(!(i<all.length)){_context2.next=11;break;}_context2.next=6;return _this.getCoords(all[i]);case 6:a=_context2.sent;newCoords.push(a);case 8:i++;_context2.next=3;break;case 11:_this.setState({coords:newCoords});case 12:case\"end\":return _context2.stop();}}},_callee2);}));_this.findMidPoint=function(coordsList){if(coordsList.length===2){var lat1=coordsList[0].lat*(Math.PI/180);var lat2=coordsList[1].lat*(Math.PI/180);var lon1=coordsList[0].lng*(Math.PI/180);var lon2=coordsList[1].lng*(Math.PI/180);var bx=Math.cos(lat2)*Math.cos(lon2-lon1);var by=Math.cos(lat2)*Math.sin(lon2-lon1);var latMid=Math.atan2(Math.sin(lat1)+Math.sin(lat2),Math.sqrt(Math.pow(Math.cos(lat1)+bx,2))+Math.pow(by,2));var lonMid=lon1+Math.atan2(by,Math.cos(lat1)+bx);return[latMid*(180/Math.PI),lonMid*(180/Math.PI)];}//Two or more addresses\nvar formatter=function formatter(x){//Converting from degrees to radians\nvar lat1=x.lat*(Math.PI/180);var lon1=x.lng*(Math.PI/180);//Converting to cartesian coords\nvar x1=Math.cos(lat1)*Math.cos(lon1);var y1=Math.cos(lat1)*Math.sin(lon1);var z1=Math.sin(lat1);return[x1,y1,z1];};var formatted=[];var _iterator2=_createForOfIteratorHelper(coordsList),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _i=_step2.value;formatted.push(formatter(_i));}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}var tmp;var newResult=[];for(var i=0;i<formatted.length;i++){tmp=0;var _iterator3=_createForOfIteratorHelper(formatted),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var j=_step3.value;tmp+=j[i];}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}newResult.push(tmp/formatted.length);}//newResult is now in format[x,y,z]\nvar lon=Math.atan2(newResult[1],newResult[0]);var hyp=Math.sqrt(Math.pow(newResult[0],2)+Math.pow(newResult[1],2));var lat=Math.atan2(newResult[2],hyp);//converting back to degrees\nlat=lat*(180/Math.PI);lon=lon*(180/Math.PI);return[lat,lon];};_this.calculator=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var midPoint;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(!_this.emptyChecker()){_context3.next=3;break;}_this.setState({midPoint:\"error\"});return _context3.abrupt(\"return\",null);case 3:if(!(_this.state.addresses.length<2)){_context3.next=6;break;}_this.setState({midPoint:\"error\"});return _context3.abrupt(\"return\",null);case 6:_context3.next=8;return _this.convertToCoords();case 8:_context3.next=10;return _this.findMidPoint(_this.state.coords);case 10:midPoint=_context3.sent;_this.setState({midPoint:midPoint,meetupPoint:{lat:midPoint[0],lng:midPoint[1]},circleLat:midPoint[0],circleLng:midPoint[1]});_this.linqupBtnChecker();_this.findNearbyPlaces();case 14:case\"end\":return _context3.stop();}}},_callee3);}));_this.findNearbyPlaces=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var newMeetupPoint,content,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(_this.state.POI===\"\")){_context4.next=4;break;}//if no Point of interest selected\nnewMeetupPoint={lat:_this.state.midPoint[0],lng:_this.state.midPoint[1]};_this.setState({meetupPoint:newMeetupPoint});return _context4.abrupt(\"return\");case 4:content={midPoint:_this.state.midPoint,radius:_this.state.radius,POI:_this.state.POI};_context4.next=7;return Axios.post(\"http://localhost:4000/nearbyplaces\",content);case 7:res=_context4.sent;if(!(res.status!==200)){_context4.next=10;break;}throw Error(res);case 10:if(!(res.data.status===\"ZERO_RESULTS\")){_context4.next=14;break;}return _context4.abrupt(\"return\");case 14:_this.setState({nearbyPlaces:res.data.results});case 15:case\"end\":return _context4.stop();}}},_callee4);}));_this.resetMidPoint=function(){_this.setState({midPoint:[]});};_this.setCurrentLocation=function(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(position){var lattt=position.coords.latitude;var longgg=position.coords.longitude;var newcoords=[lattt,longgg];_this.setState({currentLocation:newcoords});});}};_this.handleSetPOI=function(e){_this.setState({POI:e});if(e===\"\"){_this.setState({nearbyPlaces:{}});}};_this.getPlaces=function(){if(_this.state.POI===\"\"){return null;}};_this.handleSetRadius=function(e){_this.setState({radius:e});};_this.handleSetTransport=function(e){var l;if(e===\"bike\"){l=\"bicycling\";}else if(e===\"car\"){l=\"driving\";}else if(e===\"walk\"){l=\"walking\";}else{l=\"transit\";}_this.setState({transportOption:l});};_this.handleSetDate=function(date){var newDate=moment(date);newDate=newDate.format(\"LLL\");_this.setState({date:newDate});};_this.handleSetMeetupPoint=function(loc){_this.setState({meetupPoint:loc});};_this.getTravelTimes=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var newMeetupPoint,targetLat,targetLon,travelTimes,originLat,originLon,time,travelMode,content,i;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(_this.state.meetupPoint===null){newMeetupPoint={lat:_this.state.midPoint[0],lng:_this.state.midPoint[1]};_this.setState({meetupPoint:newMeetupPoint});}if(!(_this.state.midPoint===\"error\"||_this.state.addresses.length===0)){_context5.next=3;break;}return _context5.abrupt(\"return\");case 3:targetLat=_this.state.meetupPoint.lat;targetLon=_this.state.meetupPoint.lng;travelTimes=[];if(_this.state.transportOption===null){//defaults to driving if nothing was selected\ntravelMode=\"driving\";}else{travelMode=_this.state.transportOption;}i=0;case 8:if(!(i<_this.state.coords.length)){_context5.next=19;break;}originLat=_this.state.coords[i].lat;originLon=_this.state.coords[i].lng;content={targetLat:targetLat,targetLon:targetLon,originLat:originLat,originLon:originLon,travelMode:travelMode};_context5.next=14;return Axios.post(\"http://localhost:4000/traveltime\",content);case 14:time=_context5.sent;travelTimes.push(time.data.routes[0].legs[0].duration);case 16:i++;_context5.next=8;break;case 19:_this.setState({travelTimes:travelTimes});_this.getLeaveTimes();case 21:case\"end\":return _context5.stop();}}},_callee5);}));_this.getLeaveTimes=function(){var travelTimes=_this.state.travelTimes;var arrivalTime=moment(_this.state.date);var leaveTimes=[];var current;for(var i=0;i<travelTimes.length;i++){current=arrivalTime.clone().subtract(travelTimes[i].value,\"seconds\");current=current.format(\"LLL\");leaveTimes.push(current);}_this.setState({leaveTimes:leaveTimes});};_this.sendEmails=function(){var emails=_this.state.emails;var leaveTimes=_this.state.leaveTimes;var coords=_this.state.coords;var meetupPoint=_this.state.meetupPoint;var text,email,content;for(var i=0;i<leaveTimes.length;i++){text=\"This is a reminder to linq up!\\nIn order to arrive at the linq up point, please depart at the following time:\\n\";text+=leaveTimes[i]+\"\\n\";text+=\"The directions to your destination can be found using this link\\n\";text+=\"https://www.google.com/maps/dir/\"+coords[i].lat+\",\"+coords[i].lng+\"/\"+meetupPoint.lat+\",\"+meetupPoint.lng+\"/\";email=emails[i];content={to:email,text:text};Axios.post(\"http://localhost:4000/sendemail\",content);}};_this.linqupBtnChecker=function(){var emails=_this.state.emails;var newStyle={display:\"inline\"};var valid=true;var re=/^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;//validating all emails before displaying linq up button to prevent email errors\nfor(var i=0;i<emails.length;i++){if(!re.test(String(emails[i]).toLowerCase())){valid=false;}}if(valid){_this.setState({linqupbtnStyle:newStyle});}};_this.showModal=function(){_this.setState({modalVisibility:true});};_this.hideModal=function(){_this.setState({modalVisibility:false});};_this.handleSetMeetName=function(name){_this.setState({meetupPointName:name});};return _this;}_createClass(Application,[{key:\"componentDidMount\",value:function componentDidMount(){this.handleSetDate(this.state.date);this.setCurrentLocation();}},{key:\"getTime\",value:function(){var _getTime=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(link){var res,data;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return fetch(link);case 2:res=_context6.sent;_context6.next=5;return res.json();case 5:data=_context6.sent;return _context6.abrupt(\"return\",data.routes[0].legs[0].duration);case 7:case\"end\":return _context6.stop();}}},_callee6);}));function getTime(_x2){return _getTime.apply(this,arguments);}return getTime;}()},{key:\"render\",value:function render(){var _this2=this;var time=this.state.date;var meetupPoint;if(this.state.meetupPoint){if(this.state.meetupPointName!==\"\"){meetupPoint=this.state.meetupPointName;}else{meetupPoint=[this.state.meetupPoint.lat,this.state.meetupPoint.lng].toString();}}return/*#__PURE__*/React.createElement(\"div\",{className:\"app\"},/*#__PURE__*/React.createElement(\"div\",{className:\"banner\"},/*#__PURE__*/React.createElement(\"div\",{className:\"jumbotron\"},/*#__PURE__*/React.createElement(\"h1\",{className:\"display-3\"},\"Linq up\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"placepicker\"},/*#__PURE__*/React.createElement(PlacePicker,{onSetRadius:function onSetRadius(e){return _this2.handleSetRadius(e);},onSetPOI:function onSetPOI(e){return _this2.handleSetPOI(e);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"directionspicker\"},/*#__PURE__*/React.createElement(DirectionsPicker,{onSetTransport:function onSetTransport(e){return _this2.handleSetTransport(e);},onSetDate:function onSetDate(date){return _this2.handleSetDate(date);}})),/*#__PURE__*/React.createElement(\"div\",{className:\"personlist\"},/*#__PURE__*/React.createElement(PersonList,{people:this.state.people,onAddPerson:function onAddPerson(){return _this2.handleAddPerson();},onDeletePerson:function onDeletePerson(){return _this2.handleDeletePerson();}})),/*#__PURE__*/React.createElement(\"div\",{className:\"buttons\"},/*#__PURE__*/React.createElement(\"div\",{className:\"buttonholder\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-outline-secondary\",onClick:this.calculator},\"Calculate\")),/*#__PURE__*/React.createElement(\"div\",{className:\"buttonholder\"},/*#__PURE__*/React.createElement(\"button\",{style:this.state.linqupbtnStyle,className:\"btn btn-outline-dark\",onClick:function onClick(){_this2.getTravelTimes();_this2.showModal();}},\"Linq up!\"))),/*#__PURE__*/React.createElement(Modal,{centered:true,isOpen:this.state.modalVisibility},/*#__PURE__*/React.createElement(ModalHeader,null,\"Linq up Confirmation\"),/*#__PURE__*/React.createElement(ModalBody,null,/*#__PURE__*/React.createElement(Alert,{color:\"warning\"},\"Linq up Time: \",time),/*#__PURE__*/React.createElement(Alert,{color:\"warning\"},\"Linq up Place: \",meetupPoint)),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-danger\",onClick:this.hideModal},\"Cancel\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success\",onClick:function onClick(){_this2.hideModal();_this2.sendEmails();}},\"Proceed\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"map\"},/*#__PURE__*/React.createElement(\"p\",{className:\"badge badge-secondary\"},\"Press Ctrl+r if map did not load\"),/*#__PURE__*/React.createElement(MapContainer,{circleLat:this.state.circleLat,circleLng:this.state.circleLng,POI:this.state.POI,addresses:this.state.addresses,currentLocation:this.state.currentLocation,coords:this.state.coords,midpoint:this.state.midPoint,radius:this.state.radius,nearbyPlaces:this.state.nearbyPlaces,onSetMeetupPoint:function onSetMeetupPoint(loc){return _this2.handleSetMeetupPoint(loc);},onSetMeetName:function onSetMeetName(name){return _this2.handleSetMeetName(name);}})));}}]);return Application;}(Component);export default Application;","map":{"version":3,"sources":["C:/Users/Alex/linq-up/src/components/Application.jsx"],"names":["React","Component","PersonList","Person","fetch","MapContainer","PlacePicker","DirectionsPicker","Axios","Alert","Modal","ModalHeader","ModalBody","ModalFooter","moment","require","Application","state","people","e","v","handleSetAddress","handleSetEmail","addresses","coords","midPoint","currentLocation","POI","radius","nearbyPlaces","transportOption","date","Date","meetupPoint","travelTimes","leaveTimes","emails","linqupbtnStyle","display","modalVisibility","meetupPointName","circleLat","circleLng","newEmails","slice","setState","newAddresses","emptyChecker","a","i","handleAddPerson","resetMidPoint","length","handleDeletePerson","newcoords","getCoords","address","bod","post","res","status","Error","body","message","data","convertToCoords","all","newCoords","push","findMidPoint","coordsList","lat1","lat","Math","PI","lat2","lon1","lng","lon2","bx","cos","by","sin","latMid","atan2","sqrt","lonMid","formatter","x","x1","y1","z1","formatted","tmp","newResult","j","lon","hyp","calculator","linqupBtnChecker","findNearbyPlaces","newMeetupPoint","content","results","setCurrentLocation","navigator","geolocation","getCurrentPosition","position","lattt","latitude","longgg","longitude","handleSetPOI","getPlaces","handleSetRadius","handleSetTransport","l","handleSetDate","newDate","format","handleSetMeetupPoint","loc","getTravelTimes","targetLat","targetLon","travelMode","originLat","originLon","time","routes","legs","duration","getLeaveTimes","arrivalTime","current","clone","subtract","value","sendEmails","text","email","to","newStyle","valid","re","test","String","toLowerCase","showModal","hideModal","handleSetMeetName","name","link","json","toString"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport PersonList from \"./PersonList\";\r\nimport Person from \"./Person\";\r\nimport fetch from \"cross-fetch\";\r\nimport MapContainer from \"./Map\";\r\nimport PlacePicker from \"./PlacePicker\";\r\nimport DirectionsPicker from \"./DirectionsPicker\";\r\nimport \"bootstrap/dist/css/bootstrap.css\";\r\nimport \"./styles.css\";\r\nimport Axios from \"axios\";\r\nimport { Alert, Modal, ModalHeader, ModalBody, ModalFooter } from \"reactstrap\";\r\nconst moment = require(\"moment\");\r\n\r\nclass Application extends Component {\r\n  state = {\r\n    people: [\r\n      <Person\r\n        key=\"1\"\r\n        value=\"1\"\r\n        onSetAddress={(e, v) => this.handleSetAddress(e, v)}\r\n        onSetEmail={(e, v) => this.handleSetEmail(e, v)}\r\n      ></Person>,\r\n      <Person\r\n        key=\"2\"\r\n        value=\"2\"\r\n        onSetAddress={(e, v) => this.handleSetAddress(e, v)}\r\n        onSetEmail={(e, v) => this.handleSetEmail(e, v)}\r\n      ></Person>,\r\n      <Person\r\n        key=\"3\"\r\n        value=\"3\"\r\n        onSetAddress={(e, v) => this.handleSetAddress(e, v)}\r\n        onSetEmail={(e, v) => this.handleSetEmail(e, v)}\r\n      ></Person>,\r\n    ],\r\n    addresses: [\"\", \"\", \"\"],\r\n\r\n    coords: [],\r\n\r\n    midPoint: \"\",\r\n\r\n    currentLocation: [],\r\n\r\n    POI: \"\",\r\n\r\n    radius: \"300\",\r\n\r\n    nearbyPlaces: {},\r\n\r\n    transportOption: null,\r\n\r\n    date: new Date(),\r\n\r\n    meetupPoint: \"\",\r\n\r\n    travelTimes: [],\r\n\r\n    leaveTimes: [],\r\n\r\n    emails: [\"\", \"\", \"\"],\r\n\r\n    linqupbtnStyle: { display: \"none\" },\r\n\r\n    modalVisibility: false,\r\n\r\n    meetupPointName: \"\",\r\n\r\n    circleLat: 0,\r\n\r\n    circleLng: 0,\r\n\r\n\r\n  };\r\n\r\n  handleSetEmail = (e, v) => {\r\n    let newEmails = this.state.emails.slice();\r\n    newEmails[v - 1] = e;\r\n    this.setState({ emails: newEmails });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.handleSetDate(this.state.date);\r\n    this.setCurrentLocation();\r\n  }\r\n\r\n  handleSetAddress = (e, v) => {\r\n    let newAddresses = this.state.addresses.slice();\r\n    newAddresses[v - 1] = e;\r\n    this.setState({ addresses: newAddresses });\r\n  };\r\n\r\n  emptyChecker = () => {\r\n    const a = this.state.addresses;\r\n\r\n    for (let i of a) {\r\n      if (i === \"\") {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  handleAddPerson = () => {\r\n    this.resetMidPoint();\r\n    let newEmails = [...this.state.emails, \"\"];\r\n    let newAddresses = [...this.state.addresses, \"\"];\r\n    this.setState({\r\n      addresses: newAddresses,\r\n      leaveTimes: [],\r\n      meetupPoint: null,\r\n      travelTimes: [],\r\n      nearbyPlaces: {},\r\n      emails: newEmails,\r\n      circleLat:0,\r\n      circleLng:0,\r\n      coords:[]\r\n    });\r\n    this.setState({\r\n      people: [\r\n        ...this.state.people,\r\n        <Person\r\n          key={this.state.people.length + 1}\r\n          value={this.state.people.length + 1}\r\n          onSetAddress={(e, v) => this.handleSetAddress(e, v)}\r\n          onSetEmail={(e, v) => this.handleSetEmail(e, v)}\r\n        ></Person>,\r\n      ],\r\n    });\r\n  };\r\n\r\n  handleDeletePerson = () => {\r\n    let newcoords = this.state.coords.slice(0, -1);\r\n    this.setState({\r\n      coords: newcoords,\r\n      leaveTimes: [],\r\n      meetupPoint: null,\r\n      travelTimes: [],\r\n      nearbyPlaces: {},\r\n      circleLat:0,\r\n      circleLng:0,\r\n      coords:[]\r\n    });\r\n\r\n    this.resetMidPoint();\r\n    let newEmails = this.state.emails.slice(0, -1);\r\n    let newAddresses = this.state.addresses.slice(0, -1);\r\n    this.setState({ addresses: newAddresses, emails: newEmails });\r\n    let people = this.state.people.slice(0, -1);\r\n    this.setState({ people });\r\n  };\r\n\r\n  getCoords = async (address) => {\r\n    let bod = { address: address };\r\n    const res = await Axios.post(\"http://localhost:4000/geolocate\", bod);\r\n\r\n    if (res.status !== 200) throw Error(res.body.message);\r\n\r\n    return res.data;\r\n  };\r\n\r\n  convertToCoords = async () => {\r\n    const all = this.state.addresses;\r\n\r\n    let newCoords = [];\r\n    let a;\r\n\r\n    for (let i = 0; i < all.length; i++) {\r\n      a = await this.getCoords(all[i]);\r\n      newCoords.push(a);\r\n    }\r\n\r\n    this.setState({ coords: newCoords });\r\n  };\r\n\r\n  findMidPoint = (coordsList) => {\r\n    if (coordsList.length === 2) {\r\n      let lat1 = coordsList[0].lat * (Math.PI / 180);\r\n      let lat2 = coordsList[1].lat * (Math.PI / 180);\r\n      let lon1 = coordsList[0].lng * (Math.PI / 180);\r\n      let lon2 = coordsList[1].lng * (Math.PI / 180);\r\n\r\n      let bx = Math.cos(lat2) * Math.cos(lon2 - lon1);\r\n      let by = Math.cos(lat2) * Math.sin(lon2 - lon1);\r\n\r\n      let latMid = Math.atan2(\r\n        Math.sin(lat1) + Math.sin(lat2),\r\n        Math.sqrt((Math.cos(lat1) + bx) ** 2) + by ** 2\r\n      );\r\n      let lonMid = lon1 + Math.atan2(by, Math.cos(lat1) + bx);\r\n\r\n      return [latMid * (180 / Math.PI), lonMid * (180 / Math.PI)];\r\n    }\r\n\r\n    //Two or more addresses\r\n\r\n    const formatter = (x) => {\r\n      //Converting from degrees to radians\r\n      let lat1 = x.lat * (Math.PI / 180);\r\n      let lon1 = x.lng * (Math.PI / 180);\r\n      //Converting to cartesian coords\r\n\r\n      let x1 = Math.cos(lat1) * Math.cos(lon1);\r\n      let y1 = Math.cos(lat1) * Math.sin(lon1);\r\n      let z1 = Math.sin(lat1);\r\n\r\n      return [x1, y1, z1];\r\n    };\r\n\r\n    let formatted = [];\r\n\r\n    for (let i of coordsList) {\r\n      formatted.push(formatter(i));\r\n    }\r\n\r\n    let tmp;\r\n    let newResult = [];\r\n\r\n    for (let i = 0; i < formatted.length; i++) {\r\n      tmp = 0;\r\n      for (let j of formatted) {\r\n        tmp += j[i];\r\n      }\r\n\r\n      newResult.push(tmp / formatted.length);\r\n    }\r\n\r\n    //newResult is now in format[x,y,z]\r\n\r\n    let lon = Math.atan2(newResult[1], newResult[0]);\r\n    let hyp = Math.sqrt(newResult[0] ** 2 + newResult[1] ** 2);\r\n    let lat = Math.atan2(newResult[2], hyp);\r\n\r\n    //converting back to degrees\r\n    lat = lat * (180 / Math.PI);\r\n    lon = lon * (180 / Math.PI);\r\n\r\n    return [lat, lon];\r\n  };\r\n\r\n  calculator = async () => {\r\n    //check if empty addresses\r\n    if (this.emptyChecker()) {\r\n      this.setState({ midPoint: \"error\" });\r\n      return null;\r\n    }\r\n\r\n    if (this.state.addresses.length < 2) {\r\n      this.setState({ midPoint: \"error\" });\r\n      return null;\r\n    }\r\n    await this.convertToCoords();\r\n    let midPoint = await this.findMidPoint(this.state.coords);\r\n    this.setState({\r\n      midPoint: midPoint,\r\n      meetupPoint: { lat: midPoint[0], lng: midPoint[1] },\r\n      circleLat: midPoint[0], circleLng:midPoint[1]\r\n    });\r\n    this.linqupBtnChecker();\r\n    this.findNearbyPlaces();\r\n  };\r\n\r\n  findNearbyPlaces = async () => {\r\n    if (this.state.POI === \"\") {\r\n      //if no Point of interest selected\r\n      let newMeetupPoint = {\r\n        lat: this.state.midPoint[0],\r\n        lng: this.state.midPoint[1],\r\n      };\r\n      this.setState({ meetupPoint: newMeetupPoint });\r\n      return;\r\n    }\r\n\r\n    const content = {\r\n      midPoint: this.state.midPoint,\r\n      radius: this.state.radius,\r\n      POI: this.state.POI,\r\n    };\r\n\r\n    const res = await Axios.post(\"http://localhost:4000/nearbyplaces\", content);\r\n\r\n    if (res.status !== 200) throw Error(res);\r\n\r\n    if (res.data.status === \"ZERO_RESULTS\") {\r\n      return;\r\n    } else {\r\n      this.setState({ nearbyPlaces: res.data.results });\r\n    }\r\n  };\r\n\r\n  resetMidPoint = () => {\r\n    this.setState({ midPoint: [] });\r\n  };\r\n\r\n  setCurrentLocation = () => {\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition((position) => {\r\n        const lattt = position.coords.latitude;\r\n        const longgg = position.coords.longitude;\r\n\r\n        let newcoords = [lattt, longgg];\r\n\r\n        this.setState({ currentLocation: newcoords });\r\n      });\r\n    }\r\n  };\r\n\r\n  handleSetPOI = (e) => {\r\n    this.setState({ POI: e });\r\n    if (e === \"\") {\r\n      this.setState({ nearbyPlaces: {} });\r\n    }\r\n  };\r\n\r\n  getPlaces = () => {\r\n    if (this.state.POI === \"\") {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  handleSetRadius = (e) => {\r\n    this.setState({ radius: e });\r\n  };\r\n\r\n  handleSetTransport = (e) => {\r\n    let l;\r\n    if (e === \"bike\") {\r\n      l = \"bicycling\";\r\n    } else if (e === \"car\") {\r\n      l = \"driving\";\r\n    } else if (e === \"walk\") {\r\n      l = \"walking\";\r\n    } else {\r\n      l = \"transit\";\r\n    }\r\n\r\n    this.setState({ transportOption: l });\r\n  };\r\n\r\n  handleSetDate = (date) => {\r\n    let newDate = moment(date);\r\n    newDate = newDate.format(\"LLL\");\r\n\r\n    this.setState({ date: newDate });\r\n  };\r\n\r\n  handleSetMeetupPoint = (loc) => {\r\n    this.setState({ meetupPoint: loc });\r\n  };\r\n\r\n  async getTime(link) {\r\n    const res = await fetch(link);\r\n    const data = await res.json();\r\n\r\n    return data.routes[0].legs[0].duration;\r\n  }\r\n\r\n  getTravelTimes = async () => {\r\n    if (this.state.meetupPoint === null) {\r\n      let newMeetupPoint = {\r\n        lat: this.state.midPoint[0],\r\n        lng: this.state.midPoint[1],\r\n      };\r\n      this.setState({ meetupPoint: newMeetupPoint });\r\n    }\r\n\r\n    if (this.state.midPoint === \"error\" || this.state.addresses.length === 0) {\r\n      return;\r\n    }\r\n\r\n    let targetLat = this.state.meetupPoint.lat;\r\n    let targetLon = this.state.meetupPoint.lng;\r\n\r\n    let travelTimes = [];\r\n\r\n    let originLat, originLon, time, travelMode, content;\r\n\r\n    if (this.state.transportOption === null) {\r\n      //defaults to driving if nothing was selected\r\n      travelMode = \"driving\";\r\n    } else {\r\n      travelMode = this.state.transportOption;\r\n    }\r\n\r\n    for (let i = 0; i < this.state.coords.length; i++) {\r\n      originLat = this.state.coords[i].lat;\r\n      originLon = this.state.coords[i].lng;\r\n\r\n      content = {\r\n        targetLat: targetLat,\r\n        targetLon: targetLon,\r\n        originLat: originLat,\r\n        originLon: originLon,\r\n        travelMode: travelMode,\r\n      };\r\n\r\n      time = await Axios.post(\"http://localhost:4000/traveltime\", content);\r\n\r\n      travelTimes.push(time.data.routes[0].legs[0].duration);\r\n    }\r\n\r\n    this.setState({ travelTimes });\r\n\r\n    this.getLeaveTimes();\r\n  };\r\n\r\n  getLeaveTimes = () => {\r\n    let travelTimes = this.state.travelTimes;\r\n    let arrivalTime = moment(this.state.date);\r\n    let leaveTimes = [];\r\n\r\n    let current;\r\n\r\n    for (let i = 0; i < travelTimes.length; i++) {\r\n      current = arrivalTime.clone().subtract(travelTimes[i].value, \"seconds\");\r\n      current = current.format(\"LLL\");\r\n      leaveTimes.push(current);\r\n    }\r\n\r\n    this.setState({ leaveTimes });\r\n  };\r\n\r\n  sendEmails = () => {\r\n    let emails = this.state.emails;\r\n    let leaveTimes = this.state.leaveTimes;\r\n    let coords = this.state.coords;\r\n    let meetupPoint = this.state.meetupPoint;\r\n\r\n    let text, email, content;\r\n\r\n    for (let i = 0; i < leaveTimes.length; i++) {\r\n      text =\r\n        \"This is a reminder to linq up!\\nIn order to arrive at the linq up point, please depart at the following time:\\n\";\r\n      text += leaveTimes[i] + \"\\n\";\r\n      text +=\r\n        \"The directions to your destination can be found using this link\\n\";\r\n      text +=\r\n        \"https://www.google.com/maps/dir/\" +\r\n        coords[i].lat +\r\n        \",\" +\r\n        coords[i].lng +\r\n        \"/\" +\r\n        meetupPoint.lat +\r\n        \",\" +\r\n        meetupPoint.lng +\r\n        \"/\";\r\n\r\n      email = emails[i];\r\n\r\n      content = { to: email, text: text };\r\n      Axios.post(\"http://localhost:4000/sendemail\", content);\r\n    }\r\n  };\r\n\r\n  linqupBtnChecker = () => {\r\n    let emails = this.state.emails;\r\n    const newStyle = { display: \"inline\" };\r\n    let valid = true;\r\n    const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    //validating all emails before displaying linq up button to prevent email errors\r\n    for (let i = 0; i < emails.length; i++) {\r\n      if (!re.test(String(emails[i]).toLowerCase())) {\r\n        valid = false;\r\n      }\r\n    }\r\n\r\n    if (valid) {\r\n      this.setState({ linqupbtnStyle: newStyle });\r\n    }\r\n  };\r\n\r\n  showModal = () => {\r\n    this.setState({ modalVisibility: true });\r\n  };\r\n\r\n  hideModal = () => {\r\n    this.setState({ modalVisibility: false });\r\n  };\r\n\r\n  handleSetMeetName = (name) => {\r\n    this.setState({ meetupPointName: name });\r\n  };\r\n\r\n  render() {\r\n    let time = this.state.date;\r\n    let meetupPoint;\r\n\r\n    if (this.state.meetupPoint) {\r\n      if (this.state.meetupPointName !== \"\") {\r\n        meetupPoint = this.state.meetupPointName;\r\n      } else {\r\n        meetupPoint = [\r\n          this.state.meetupPoint.lat,\r\n          this.state.meetupPoint.lng,\r\n        ].toString();\r\n      }\r\n    }\r\n\r\n    return (\r\n      <div className=\"app\">\r\n        <div className=\"banner\">\r\n          <div className=\"jumbotron\">\r\n            <h1 className=\"display-3\">Linq up</h1>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"placepicker\">\r\n          <PlacePicker\r\n            onSetRadius={(e) => this.handleSetRadius(e)}\r\n            onSetPOI={(e) => this.handleSetPOI(e)}\r\n          ></PlacePicker>\r\n        </div>\r\n\r\n        <div className=\"directionspicker\">\r\n          <DirectionsPicker\r\n            onSetTransport={(e) => this.handleSetTransport(e)}\r\n            onSetDate={(date) => this.handleSetDate(date)}\r\n          ></DirectionsPicker>\r\n        </div>\r\n\r\n        <div className=\"personlist\">\r\n          <PersonList\r\n            people={this.state.people}\r\n            onAddPerson={() => this.handleAddPerson()}\r\n            onDeletePerson={() => this.handleDeletePerson()}\r\n          ></PersonList>\r\n        </div>\r\n\r\n        <div className=\"buttons\">\r\n          <div className=\"buttonholder\">\r\n            <button\r\n              className=\"btn btn-outline-secondary\"\r\n              onClick={this.calculator}\r\n            >\r\n              Calculate\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"buttonholder\">\r\n            <button\r\n              style={this.state.linqupbtnStyle}\r\n              className=\"btn btn-outline-dark\"\r\n              onClick={() => {\r\n                this.getTravelTimes();\r\n                this.showModal();\r\n              }}\r\n            >\r\n              Linq up!\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <Modal centered={true} isOpen={this.state.modalVisibility}>\r\n          <ModalHeader>Linq up Confirmation</ModalHeader>\r\n          <ModalBody>\r\n            <Alert color=\"warning\">Linq up Time: {time}</Alert>\r\n            <Alert color=\"warning\">Linq up Place: {meetupPoint}</Alert>\r\n          </ModalBody>\r\n          <ModalFooter>\r\n            <button className=\"btn btn-danger\" onClick={this.hideModal}>\r\n              Cancel\r\n            </button>\r\n            <button\r\n              className=\"btn btn-success\"\r\n              onClick={() => {\r\n                this.hideModal();\r\n                this.sendEmails();\r\n              }}\r\n            >\r\n              Proceed\r\n            </button>\r\n          </ModalFooter>\r\n        </Modal>\r\n\r\n        <div className=\"map\">\r\n          <p className=\"badge badge-secondary\">Press Ctrl+r if map did not load</p>\r\n          <MapContainer\r\n            circleLat={this.state.circleLat}\r\n            circleLng={this.state.circleLng}\r\n            POI={this.state.POI}\r\n            addresses={this.state.addresses}\r\n            currentLocation={this.state.currentLocation}\r\n            coords={this.state.coords}\r\n            midpoint={this.state.midPoint}\r\n            radius={this.state.radius}\r\n            nearbyPlaces={this.state.nearbyPlaces}\r\n            onSetMeetupPoint={(loc) => this.handleSetMeetupPoint(loc)}\r\n            onSetMeetName={(name) => this.handleSetMeetName(name)}\r\n          ></MapContainer>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Application;\r\n"]},"metadata":{},"sourceType":"module"}