{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Alex\\\\linq-up\\\\src\\\\components\\\\Application.jsx\";\nimport React, { Component } from \"react\";\nimport PersonList from \"./PersonList\";\nimport Person from \"./Person\";\nimport fetch from \"cross-fetch\";\nimport MapContainer from \"./Map\";\nimport PlacePicker from \"./PlacePicker\";\nimport DirectionsPicker from \"./DirectionsPicker\";\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"./styles.css\";\nimport Axios from \"axios\";\nimport { Alert, Modal, ModalHeader, ModalBody, ModalFooter } from \"reactstrap\";\n\nconst moment = require(\"moment\");\n\nclass Application extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      people: [/*#__PURE__*/React.createElement(Person, {\n        key: \"1\",\n        value: \"1\",\n        onSetAddress: (e, v) => this.handleSetAddress(e, v),\n        onSetEmail: (e, v) => this.handleSetEmail(e, v),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 17,\n          columnNumber: 7\n        }\n      }), /*#__PURE__*/React.createElement(Person, {\n        key: \"2\",\n        value: \"2\",\n        onSetAddress: (e, v) => this.handleSetAddress(e, v),\n        onSetEmail: (e, v) => this.handleSetEmail(e, v),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 23,\n          columnNumber: 7\n        }\n      }), /*#__PURE__*/React.createElement(Person, {\n        key: \"3\",\n        value: \"3\",\n        onSetAddress: (e, v) => this.handleSetAddress(e, v),\n        onSetEmail: (e, v) => this.handleSetEmail(e, v),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 29,\n          columnNumber: 7\n        }\n      })],\n      addresses: [\"\", \"\", \"\"],\n      coords: [],\n      midPoint: \"\",\n      currentLocation: [],\n      POI: \"\",\n      radius: \"300\",\n      nearbyPlaces: {},\n      transportOption: null,\n      date: new Date(),\n      meetupPoint: \"\",\n      travelTimes: [],\n      leaveTimes: [],\n      emails: [\"\", \"\", \"\"],\n      linqupbtnStyle: {\n        display: \"none\"\n      },\n      modalVisibility: false,\n      meetupPointName: \"\",\n      circleLat: 0,\n      circleLng: 0\n    };\n\n    this.handleSetEmail = (e, v) => {\n      let newEmails = this.state.emails.slice();\n      newEmails[v - 1] = e;\n      this.setState({\n        emails: newEmails\n      });\n    };\n\n    this.handleSetAddress = (e, v) => {\n      let newAddresses = this.state.addresses.slice();\n      newAddresses[v - 1] = e;\n      this.setState({\n        addresses: newAddresses\n      });\n    };\n\n    this.emptyChecker = () => {\n      const a = this.state.addresses;\n\n      for (let i of a) {\n        if (i === \"\") {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    this.handleAddPerson = () => {\n      this.resetMidPoint();\n      let newEmails = [...this.state.emails, \"\"];\n      let newAddresses = [...this.state.addresses, \"\"];\n      this.setState({\n        addresses: newAddresses,\n        leaveTimes: [],\n        meetupPoint: null,\n        travelTimes: [],\n        nearbyPlaces: {},\n        emails: newEmails,\n        circleLat: 0,\n        circleLng: 0,\n        coords: []\n      });\n      this.setState({\n        people: [...this.state.people, /*#__PURE__*/React.createElement(Person, {\n          key: this.state.people.length + 1,\n          value: this.state.people.length + 1,\n          onSetAddress: (e, v) => this.handleSetAddress(e, v),\n          onSetEmail: (e, v) => this.handleSetEmail(e, v),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 9\n          }\n        })]\n      });\n    };\n\n    this.handleDeletePerson = () => {\n      let newcoords = this.state.coords.slice(0, -1);\n      this.setState({\n        coords: newcoords,\n        leaveTimes: [],\n        meetupPoint: null,\n        travelTimes: [],\n        nearbyPlaces: {},\n        circleLat: 0,\n        circleLng: 0,\n        coords: []\n      });\n      this.resetMidPoint();\n      let newEmails = this.state.emails.slice(0, -1);\n      let newAddresses = this.state.addresses.slice(0, -1);\n      this.setState({\n        addresses: newAddresses,\n        emails: newEmails\n      });\n      let people = this.state.people.slice(0, -1);\n      this.setState({\n        people\n      });\n    };\n\n    this.getCoords = async address => {\n      let bod = {\n        address: address\n      };\n      const res = await Axios.post(\"http://localhost:4000/geolocate\", bod);\n      if (res.status !== 200) throw Error(res.body.message);\n      return res.data;\n    };\n\n    this.convertToCoords = async () => {\n      const all = this.state.addresses;\n      let newCoords = [];\n      let a;\n\n      for (let i = 0; i < all.length; i++) {\n        a = await this.getCoords(all[i]);\n        newCoords.push(a);\n      }\n\n      this.setState({\n        coords: newCoords\n      });\n    };\n\n    this.findMidPoint = coordsList => {\n      if (coordsList.length === 2) {\n        let lat1 = coordsList[0].lat * (Math.PI / 180);\n        let lat2 = coordsList[1].lat * (Math.PI / 180);\n        let lon1 = coordsList[0].lng * (Math.PI / 180);\n        let lon2 = coordsList[1].lng * (Math.PI / 180);\n        let bx = Math.cos(lat2) * Math.cos(lon2 - lon1);\n        let by = Math.cos(lat2) * Math.sin(lon2 - lon1);\n        let latMid = Math.atan2(Math.sin(lat1) + Math.sin(lat2), Math.sqrt((Math.cos(lat1) + bx) ** 2) + by ** 2);\n        let lonMid = lon1 + Math.atan2(by, Math.cos(lat1) + bx);\n        return [latMid * (180 / Math.PI), lonMid * (180 / Math.PI)];\n      } //Two or more addresses\n\n\n      const formatter = x => {\n        //Converting from degrees to radians\n        let lat1 = x.lat * (Math.PI / 180);\n        let lon1 = x.lng * (Math.PI / 180); //Converting to cartesian coords\n\n        let x1 = Math.cos(lat1) * Math.cos(lon1);\n        let y1 = Math.cos(lat1) * Math.sin(lon1);\n        let z1 = Math.sin(lat1);\n        return [x1, y1, z1];\n      };\n\n      let formatted = [];\n\n      for (let i of coordsList) {\n        formatted.push(formatter(i));\n      }\n\n      let tmp;\n      let newResult = [];\n\n      for (let i = 0; i < formatted.length; i++) {\n        tmp = 0;\n\n        for (let j of formatted) {\n          tmp += j[i];\n        }\n\n        newResult.push(tmp / formatted.length);\n      } //newResult is now in format[x,y,z]\n\n\n      let lon = Math.atan2(newResult[1], newResult[0]);\n      let hyp = Math.sqrt(newResult[0] ** 2 + newResult[1] ** 2);\n      let lat = Math.atan2(newResult[2], hyp); //converting back to degrees\n\n      lat = lat * (180 / Math.PI);\n      lon = lon * (180 / Math.PI);\n      return [lat, lon];\n    };\n\n    this.calculator = async () => {\n      //check if empty addresses\n      if (this.emptyChecker()) {\n        this.setState({\n          midPoint: \"error\"\n        });\n        return null;\n      }\n\n      if (this.state.addresses.length < 2) {\n        this.setState({\n          midPoint: \"error\"\n        });\n        return null;\n      }\n\n      await this.convertToCoords();\n      let midPoint = await this.findMidPoint(this.state.coords);\n      this.setState({\n        midPoint: midPoint,\n        meetupPoint: {\n          lat: midPoint[0],\n          lng: midPoint[1]\n        },\n        circleLat: midPoint[0],\n        circleLng: midPoint[1]\n      });\n      this.linqupBtnChecker();\n      this.findNearbyPlaces();\n    };\n\n    this.findNearbyPlaces = async () => {\n      if (this.state.POI === \"\") {\n        //if no Point of interest selected\n        let newMeetupPoint = {\n          lat: this.state.midPoint[0],\n          lng: this.state.midPoint[1]\n        };\n        this.setState({\n          meetupPoint: newMeetupPoint\n        });\n        return;\n      }\n\n      const content = {\n        midPoint: this.state.midPoint,\n        radius: this.state.radius,\n        POI: this.state.POI\n      };\n      const res = await Axios.post(\"http://localhost:4000/nearbyplaces\", content);\n      if (res.status !== 200) throw Error(res);\n\n      if (res.data.status === \"ZERO_RESULTS\") {\n        return;\n      } else {\n        this.setState({\n          nearbyPlaces: res.data.results\n        });\n      }\n    };\n\n    this.resetMidPoint = () => {\n      this.setState({\n        midPoint: []\n      });\n    };\n\n    this.setCurrentLocation = () => {\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(position => {\n          const lattt = position.coords.latitude;\n          const longgg = position.coords.longitude;\n          let newcoords = [lattt, longgg];\n          this.setState({\n            currentLocation: newcoords\n          });\n        });\n      }\n    };\n\n    this.handleSetPOI = e => {\n      this.setState({\n        POI: e\n      });\n\n      if (e === \"\") {\n        this.setState({\n          nearbyPlaces: {}\n        });\n      }\n    };\n\n    this.getPlaces = () => {\n      if (this.state.POI === \"\") {\n        return null;\n      }\n    };\n\n    this.handleSetRadius = e => {\n      this.setState({\n        radius: e\n      });\n    };\n\n    this.handleSetTransport = e => {\n      let l;\n\n      if (e === \"bike\") {\n        l = \"bicycling\";\n      } else if (e === \"car\") {\n        l = \"driving\";\n      } else if (e === \"walk\") {\n        l = \"walking\";\n      } else {\n        l = \"transit\";\n      }\n\n      this.setState({\n        transportOption: l\n      });\n    };\n\n    this.handleSetDate = date => {\n      let newDate = moment(date);\n      newDate = newDate.format(\"LLL\");\n      this.setState({\n        date: newDate\n      });\n    };\n\n    this.handleSetMeetupPoint = loc => {\n      this.setState({\n        meetupPoint: loc\n      });\n    };\n\n    this.getTravelTimes = async () => {\n      if (this.state.meetupPoint === null) {\n        let newMeetupPoint = {\n          lat: this.state.midPoint[0],\n          lng: this.state.midPoint[1]\n        };\n        this.setState({\n          meetupPoint: newMeetupPoint\n        });\n      }\n\n      if (this.state.midPoint === \"error\" || this.state.addresses.length === 0) {\n        return;\n      }\n\n      let targetLat = this.state.meetupPoint.lat;\n      let targetLon = this.state.meetupPoint.lng;\n      let travelTimes = [];\n      let originLat, originLon, time, travelMode, content;\n\n      if (this.state.transportOption === null) {\n        //defaults to driving if nothing was selected\n        travelMode = \"driving\";\n      } else {\n        travelMode = this.state.transportOption;\n      }\n\n      for (let i = 0; i < this.state.coords.length; i++) {\n        originLat = this.state.coords[i].lat;\n        originLon = this.state.coords[i].lng;\n        content = {\n          targetLat: targetLat,\n          targetLon: targetLon,\n          originLat: originLat,\n          originLon: originLon,\n          travelMode: travelMode\n        };\n        time = await Axios.post(\"http://localhost:4000/traveltime\", content);\n        travelTimes.push(time.data.routes[0].legs[0].duration);\n      }\n\n      this.setState({\n        travelTimes\n      });\n      this.getLeaveTimes();\n    };\n\n    this.getLeaveTimes = () => {\n      let travelTimes = this.state.travelTimes;\n      let arrivalTime = moment(this.state.date);\n      let leaveTimes = [];\n      let current;\n\n      for (let i = 0; i < travelTimes.length; i++) {\n        current = arrivalTime.clone().subtract(travelTimes[i].value, \"seconds\");\n        current = current.format(\"LLL\");\n        leaveTimes.push(current);\n      }\n\n      this.setState({\n        leaveTimes\n      });\n    };\n\n    this.sendEmails = () => {\n      let emails = this.state.emails;\n      let leaveTimes = this.state.leaveTimes;\n      let coords = this.state.coords;\n      let meetupPoint = this.state.meetupPoint;\n      let text, email, content;\n\n      for (let i = 0; i < leaveTimes.length; i++) {\n        text = \"This is a reminder to linq up!\\nIn order to arrive at the linq up point, please depart at the following time:\\n\";\n        text += leaveTimes[i] + \"\\n\";\n        text += \"The directions to your destination can be found using this link\\n\";\n        text += \"https://www.google.com/maps/dir/\" + coords[i].lat + \",\" + coords[i].lng + \"/\" + meetupPoint.lat + \",\" + meetupPoint.lng + \"/\";\n        email = emails[i];\n        content = {\n          to: email,\n          text: text\n        };\n        Axios.post(\"http://localhost:4000/sendemail\", content);\n      }\n    };\n\n    this.linqupBtnChecker = () => {\n      let emails = this.state.emails;\n      const newStyle = {\n        display: \"inline\"\n      };\n      let valid = true;\n      const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/; //validating all emails before displaying linq up button to prevent email errors\n\n      for (let i = 0; i < emails.length; i++) {\n        if (!re.test(String(emails[i]).toLowerCase())) {\n          valid = false;\n        }\n      }\n\n      if (valid) {\n        this.setState({\n          linqupbtnStyle: newStyle\n        });\n      }\n    };\n\n    this.showModal = () => {\n      this.setState({\n        modalVisibility: true\n      });\n    };\n\n    this.hideModal = () => {\n      this.setState({\n        modalVisibility: false\n      });\n    };\n\n    this.handleSetMeetName = name => {\n      this.setState({\n        meetupPointName: name\n      });\n    };\n  }\n\n  componentDidMount() {\n    this.handleSetDate(this.state.date);\n    this.setCurrentLocation();\n  }\n\n  async getTime(link) {\n    const res = await fetch(link);\n    const data = await res.json();\n    return data.routes[0].legs[0].duration;\n  }\n\n  render() {\n    let time = this.state.date;\n    let meetupPoint;\n\n    if (this.state.meetupPoint) {\n      if (this.state.meetupPointName !== \"\") {\n        meetupPoint = this.state.meetupPointName;\n      } else {\n        meetupPoint = [this.state.meetupPoint.lat, this.state.meetupPoint.lng].toString();\n      }\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"app\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"banner\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 500,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"jumbotron\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 501,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      className: \"display-3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 13\n      }\n    }, \"Linq up\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"placepicker\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 506,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(PlacePicker, {\n      onSetRadius: e => this.handleSetRadius(e),\n      onSetPOI: e => this.handleSetPOI(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 507,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"directionspicker\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 513,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(DirectionsPicker, {\n      onSetTransport: e => this.handleSetTransport(e),\n      onSetDate: date => this.handleSetDate(date),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 514,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"personlist\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 520,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(PersonList, {\n      people: this.state.people,\n      onAddPerson: () => this.handleAddPerson(),\n      onDeletePerson: () => this.handleDeletePerson(),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 521,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"buttons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 528,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"buttonholder\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 529,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-outline-secondary\",\n      onClick: this.calculator,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 13\n      }\n    }, \"Calculate\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"buttonholder\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 538,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      style: this.state.linqupbtnStyle,\n      className: \"btn btn-outline-dark\",\n      onClick: () => {\n        this.getTravelTimes();\n        this.showModal();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 539,\n        columnNumber: 13\n      }\n    }, \"Linq up!\"))), /*#__PURE__*/React.createElement(Modal, {\n      centered: true,\n      isOpen: this.state.modalVisibility,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 552,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ModalHeader, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 11\n      }\n    }, \"Linq up Confirmation\"), /*#__PURE__*/React.createElement(ModalBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Alert, {\n      color: \"warning\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 555,\n        columnNumber: 13\n      }\n    }, \"Linq up Time: \", time), /*#__PURE__*/React.createElement(Alert, {\n      color: \"warning\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 556,\n        columnNumber: 13\n      }\n    }, \"Linq up Place: \", meetupPoint)), /*#__PURE__*/React.createElement(ModalFooter, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 558,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-danger\",\n      onClick: this.hideModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 559,\n        columnNumber: 13\n      }\n    }, \"Cancel\"), /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn btn-success\",\n      onClick: () => {\n        this.hideModal();\n        this.sendEmails();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 562,\n        columnNumber: 13\n      }\n    }, \"Proceed\"))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"map\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 574,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"p\", {\n      className: \"badge badge-secondary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 11\n      }\n    }, \"Press Ctrl+r if map did not load\"), /*#__PURE__*/React.createElement(MapContainer, {\n      circleLat: this.state.circleLat,\n      circleLng: this.state.circleLng,\n      POI: this.state.POI,\n      addresses: this.state.addresses,\n      currentLocation: this.state.currentLocation,\n      coords: this.state.coords,\n      midpoint: this.state.midPoint,\n      radius: this.state.radius,\n      nearbyPlaces: this.state.nearbyPlaces,\n      onSetMeetupPoint: loc => this.handleSetMeetupPoint(loc),\n      onSetMeetName: name => this.handleSetMeetName(name),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 576,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nexport default Application;","map":{"version":3,"sources":["C:/Users/Alex/linq-up/src/components/Application.jsx"],"names":["React","Component","PersonList","Person","fetch","MapContainer","PlacePicker","DirectionsPicker","Axios","Alert","Modal","ModalHeader","ModalBody","ModalFooter","moment","require","Application","state","people","e","v","handleSetAddress","handleSetEmail","addresses","coords","midPoint","currentLocation","POI","radius","nearbyPlaces","transportOption","date","Date","meetupPoint","travelTimes","leaveTimes","emails","linqupbtnStyle","display","modalVisibility","meetupPointName","circleLat","circleLng","newEmails","slice","setState","newAddresses","emptyChecker","a","i","handleAddPerson","resetMidPoint","length","handleDeletePerson","newcoords","getCoords","address","bod","res","post","status","Error","body","message","data","convertToCoords","all","newCoords","push","findMidPoint","coordsList","lat1","lat","Math","PI","lat2","lon1","lng","lon2","bx","cos","by","sin","latMid","atan2","sqrt","lonMid","formatter","x","x1","y1","z1","formatted","tmp","newResult","j","lon","hyp","calculator","linqupBtnChecker","findNearbyPlaces","newMeetupPoint","content","results","setCurrentLocation","navigator","geolocation","getCurrentPosition","position","lattt","latitude","longgg","longitude","handleSetPOI","getPlaces","handleSetRadius","handleSetTransport","l","handleSetDate","newDate","format","handleSetMeetupPoint","loc","getTravelTimes","targetLat","targetLon","originLat","originLon","time","travelMode","routes","legs","duration","getLeaveTimes","arrivalTime","current","clone","subtract","value","sendEmails","text","email","to","newStyle","valid","re","test","String","toLowerCase","showModal","hideModal","handleSetMeetName","name","componentDidMount","getTime","link","json","render","toString"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport PersonList from \"./PersonList\";\r\nimport Person from \"./Person\";\r\nimport fetch from \"cross-fetch\";\r\nimport MapContainer from \"./Map\";\r\nimport PlacePicker from \"./PlacePicker\";\r\nimport DirectionsPicker from \"./DirectionsPicker\";\r\nimport \"bootstrap/dist/css/bootstrap.css\";\r\nimport \"./styles.css\";\r\nimport Axios from \"axios\";\r\nimport { Alert, Modal, ModalHeader, ModalBody, ModalFooter } from \"reactstrap\";\r\nconst moment = require(\"moment\");\r\n\r\nclass Application extends Component {\r\n  state = {\r\n    people: [\r\n      <Person\r\n        key=\"1\"\r\n        value=\"1\"\r\n        onSetAddress={(e, v) => this.handleSetAddress(e, v)}\r\n        onSetEmail={(e, v) => this.handleSetEmail(e, v)}\r\n      ></Person>,\r\n      <Person\r\n        key=\"2\"\r\n        value=\"2\"\r\n        onSetAddress={(e, v) => this.handleSetAddress(e, v)}\r\n        onSetEmail={(e, v) => this.handleSetEmail(e, v)}\r\n      ></Person>,\r\n      <Person\r\n        key=\"3\"\r\n        value=\"3\"\r\n        onSetAddress={(e, v) => this.handleSetAddress(e, v)}\r\n        onSetEmail={(e, v) => this.handleSetEmail(e, v)}\r\n      ></Person>,\r\n    ],\r\n    addresses: [\"\", \"\", \"\"],\r\n\r\n    coords: [],\r\n\r\n    midPoint: \"\",\r\n\r\n    currentLocation: [],\r\n\r\n    POI: \"\",\r\n\r\n    radius: \"300\",\r\n\r\n    nearbyPlaces: {},\r\n\r\n    transportOption: null,\r\n\r\n    date: new Date(),\r\n\r\n    meetupPoint: \"\",\r\n\r\n    travelTimes: [],\r\n\r\n    leaveTimes: [],\r\n\r\n    emails: [\"\", \"\", \"\"],\r\n\r\n    linqupbtnStyle: { display: \"none\" },\r\n\r\n    modalVisibility: false,\r\n\r\n    meetupPointName: \"\",\r\n\r\n    circleLat: 0,\r\n\r\n    circleLng: 0,\r\n\r\n  };\r\n\r\n  handleSetEmail = (e, v) => {\r\n    let newEmails = this.state.emails.slice();\r\n    newEmails[v - 1] = e;\r\n    this.setState({ emails: newEmails });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.handleSetDate(this.state.date);\r\n    this.setCurrentLocation();\r\n  }\r\n\r\n  handleSetAddress = (e, v) => {\r\n    let newAddresses = this.state.addresses.slice();\r\n    newAddresses[v - 1] = e;\r\n    this.setState({ addresses: newAddresses });\r\n  };\r\n\r\n  emptyChecker = () => {\r\n    const a = this.state.addresses;\r\n\r\n    for (let i of a) {\r\n      if (i === \"\") {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  };\r\n\r\n  handleAddPerson = () => {\r\n    this.resetMidPoint();\r\n    let newEmails = [...this.state.emails, \"\"];\r\n    let newAddresses = [...this.state.addresses, \"\"];\r\n    this.setState({\r\n      addresses: newAddresses,\r\n      leaveTimes: [],\r\n      meetupPoint: null,\r\n      travelTimes: [],\r\n      nearbyPlaces: {},\r\n      emails: newEmails,\r\n      circleLat:0,\r\n      circleLng:0,\r\n      coords:[]\r\n    });\r\n    this.setState({\r\n      people: [\r\n        ...this.state.people,\r\n        <Person\r\n          key={this.state.people.length + 1}\r\n          value={this.state.people.length + 1}\r\n          onSetAddress={(e, v) => this.handleSetAddress(e, v)}\r\n          onSetEmail={(e, v) => this.handleSetEmail(e, v)}\r\n        ></Person>,\r\n      ],\r\n    });\r\n  };\r\n\r\n  handleDeletePerson = () => {\r\n    let newcoords = this.state.coords.slice(0, -1);\r\n    this.setState({\r\n      coords: newcoords,\r\n      leaveTimes: [],\r\n      meetupPoint: null,\r\n      travelTimes: [],\r\n      nearbyPlaces: {},\r\n      circleLat:0,\r\n      circleLng:0,\r\n      coords:[]\r\n    });\r\n\r\n    this.resetMidPoint();\r\n    let newEmails = this.state.emails.slice(0, -1);\r\n    let newAddresses = this.state.addresses.slice(0, -1);\r\n    this.setState({ addresses: newAddresses, emails: newEmails });\r\n    let people = this.state.people.slice(0, -1);\r\n    this.setState({ people });\r\n  };\r\n\r\n  getCoords = async (address) => {\r\n    let bod = { address: address };\r\n    const res = await Axios.post(\"http://localhost:4000/geolocate\", bod);\r\n\r\n    if (res.status !== 200) throw Error(res.body.message);\r\n\r\n    return res.data;\r\n  };\r\n\r\n  convertToCoords = async () => {\r\n    const all = this.state.addresses;\r\n\r\n    let newCoords = [];\r\n    let a;\r\n\r\n    for (let i = 0; i < all.length; i++) {\r\n      a = await this.getCoords(all[i]);\r\n      newCoords.push(a);\r\n    }\r\n\r\n    this.setState({ coords: newCoords });\r\n  };\r\n\r\n  findMidPoint = (coordsList) => {\r\n    if (coordsList.length === 2) {\r\n      let lat1 = coordsList[0].lat * (Math.PI / 180);\r\n      let lat2 = coordsList[1].lat * (Math.PI / 180);\r\n      let lon1 = coordsList[0].lng * (Math.PI / 180);\r\n      let lon2 = coordsList[1].lng * (Math.PI / 180);\r\n\r\n      let bx = Math.cos(lat2) * Math.cos(lon2 - lon1);\r\n      let by = Math.cos(lat2) * Math.sin(lon2 - lon1);\r\n\r\n      let latMid = Math.atan2(\r\n        Math.sin(lat1) + Math.sin(lat2),\r\n        Math.sqrt((Math.cos(lat1) + bx) ** 2) + by ** 2\r\n      );\r\n      let lonMid = lon1 + Math.atan2(by, Math.cos(lat1) + bx);\r\n\r\n      return [latMid * (180 / Math.PI), lonMid * (180 / Math.PI)];\r\n    }\r\n\r\n    //Two or more addresses\r\n\r\n    const formatter = (x) => {\r\n      //Converting from degrees to radians\r\n      let lat1 = x.lat * (Math.PI / 180);\r\n      let lon1 = x.lng * (Math.PI / 180);\r\n      //Converting to cartesian coords\r\n\r\n      let x1 = Math.cos(lat1) * Math.cos(lon1);\r\n      let y1 = Math.cos(lat1) * Math.sin(lon1);\r\n      let z1 = Math.sin(lat1);\r\n\r\n      return [x1, y1, z1];\r\n    };\r\n\r\n    let formatted = [];\r\n\r\n    for (let i of coordsList) {\r\n      formatted.push(formatter(i));\r\n    }\r\n\r\n    let tmp;\r\n    let newResult = [];\r\n\r\n    for (let i = 0; i < formatted.length; i++) {\r\n      tmp = 0;\r\n      for (let j of formatted) {\r\n        tmp += j[i];\r\n      }\r\n\r\n      newResult.push(tmp / formatted.length);\r\n    }\r\n\r\n    //newResult is now in format[x,y,z]\r\n\r\n    let lon = Math.atan2(newResult[1], newResult[0]);\r\n    let hyp = Math.sqrt(newResult[0] ** 2 + newResult[1] ** 2);\r\n    let lat = Math.atan2(newResult[2], hyp);\r\n\r\n    //converting back to degrees\r\n    lat = lat * (180 / Math.PI);\r\n    lon = lon * (180 / Math.PI);\r\n\r\n    return [lat, lon];\r\n  };\r\n\r\n  calculator = async () => {\r\n    //check if empty addresses\r\n    if (this.emptyChecker()) {\r\n      this.setState({ midPoint: \"error\" });\r\n      return null;\r\n    }\r\n\r\n    if (this.state.addresses.length < 2) {\r\n      this.setState({ midPoint: \"error\" });\r\n      return null;\r\n    }\r\n    await this.convertToCoords();\r\n    let midPoint = await this.findMidPoint(this.state.coords);\r\n    this.setState({\r\n      midPoint: midPoint,\r\n      meetupPoint: { lat: midPoint[0], lng: midPoint[1] },\r\n      circleLat: midPoint[0], circleLng:midPoint[1]\r\n    });\r\n    this.linqupBtnChecker();\r\n    this.findNearbyPlaces();\r\n  };\r\n\r\n  findNearbyPlaces = async () => {\r\n    if (this.state.POI === \"\") {\r\n      //if no Point of interest selected\r\n      let newMeetupPoint = {\r\n        lat: this.state.midPoint[0],\r\n        lng: this.state.midPoint[1],\r\n      };\r\n      this.setState({ meetupPoint: newMeetupPoint });\r\n      return;\r\n    }\r\n\r\n    const content = {\r\n      midPoint: this.state.midPoint,\r\n      radius: this.state.radius,\r\n      POI: this.state.POI,\r\n    };\r\n\r\n    const res = await Axios.post(\"http://localhost:4000/nearbyplaces\", content);\r\n\r\n    if (res.status !== 200) throw Error(res);\r\n\r\n    if (res.data.status === \"ZERO_RESULTS\") {\r\n      return;\r\n    } else {\r\n      this.setState({ nearbyPlaces: res.data.results });\r\n    }\r\n  };\r\n\r\n  resetMidPoint = () => {\r\n    this.setState({ midPoint: [] });\r\n  };\r\n\r\n  setCurrentLocation = () => {\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition((position) => {\r\n        const lattt = position.coords.latitude;\r\n        const longgg = position.coords.longitude;\r\n\r\n        let newcoords = [lattt, longgg];\r\n\r\n        this.setState({ currentLocation: newcoords });\r\n      });\r\n    }\r\n  };\r\n\r\n  handleSetPOI = (e) => {\r\n    this.setState({ POI: e });\r\n    if (e === \"\") {\r\n      this.setState({ nearbyPlaces: {} });\r\n    }\r\n  };\r\n\r\n  getPlaces = () => {\r\n    if (this.state.POI === \"\") {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  handleSetRadius = (e) => {\r\n    this.setState({ radius: e });\r\n  };\r\n\r\n  handleSetTransport = (e) => {\r\n    let l;\r\n    if (e === \"bike\") {\r\n      l = \"bicycling\";\r\n    } else if (e === \"car\") {\r\n      l = \"driving\";\r\n    } else if (e === \"walk\") {\r\n      l = \"walking\";\r\n    } else {\r\n      l = \"transit\";\r\n    }\r\n\r\n    this.setState({ transportOption: l });\r\n  };\r\n\r\n  handleSetDate = (date) => {\r\n    let newDate = moment(date);\r\n    newDate = newDate.format(\"LLL\");\r\n\r\n    this.setState({ date: newDate });\r\n  };\r\n\r\n  handleSetMeetupPoint = (loc) => {\r\n    this.setState({ meetupPoint: loc });\r\n  };\r\n\r\n  async getTime(link) {\r\n    const res = await fetch(link);\r\n    const data = await res.json();\r\n\r\n    return data.routes[0].legs[0].duration;\r\n  }\r\n\r\n  getTravelTimes = async () => {\r\n    if (this.state.meetupPoint === null) {\r\n      let newMeetupPoint = {\r\n        lat: this.state.midPoint[0],\r\n        lng: this.state.midPoint[1],\r\n      };\r\n      this.setState({ meetupPoint: newMeetupPoint });\r\n    }\r\n\r\n    if (this.state.midPoint === \"error\" || this.state.addresses.length === 0) {\r\n      return;\r\n    }\r\n\r\n    let targetLat = this.state.meetupPoint.lat;\r\n    let targetLon = this.state.meetupPoint.lng;\r\n\r\n    let travelTimes = [];\r\n\r\n    let originLat, originLon, time, travelMode, content;\r\n\r\n    if (this.state.transportOption === null) {\r\n      //defaults to driving if nothing was selected\r\n      travelMode = \"driving\";\r\n    } else {\r\n      travelMode = this.state.transportOption;\r\n    }\r\n\r\n    for (let i = 0; i < this.state.coords.length; i++) {\r\n      originLat = this.state.coords[i].lat;\r\n      originLon = this.state.coords[i].lng;\r\n\r\n      content = {\r\n        targetLat: targetLat,\r\n        targetLon: targetLon,\r\n        originLat: originLat,\r\n        originLon: originLon,\r\n        travelMode: travelMode,\r\n      };\r\n\r\n      time = await Axios.post(\"http://localhost:4000/traveltime\", content);\r\n\r\n      travelTimes.push(time.data.routes[0].legs[0].duration);\r\n    }\r\n\r\n    this.setState({ travelTimes });\r\n\r\n    this.getLeaveTimes();\r\n  };\r\n\r\n  getLeaveTimes = () => {\r\n    let travelTimes = this.state.travelTimes;\r\n    let arrivalTime = moment(this.state.date);\r\n    let leaveTimes = [];\r\n\r\n    let current;\r\n\r\n    for (let i = 0; i < travelTimes.length; i++) {\r\n      current = arrivalTime.clone().subtract(travelTimes[i].value, \"seconds\");\r\n      current = current.format(\"LLL\");\r\n      leaveTimes.push(current);\r\n    }\r\n\r\n    this.setState({ leaveTimes });\r\n  };\r\n\r\n  sendEmails = () => {\r\n    let emails = this.state.emails;\r\n    let leaveTimes = this.state.leaveTimes;\r\n    let coords = this.state.coords;\r\n    let meetupPoint = this.state.meetupPoint;\r\n\r\n    let text, email, content;\r\n\r\n    for (let i = 0; i < leaveTimes.length; i++) {\r\n      text =\r\n        \"This is a reminder to linq up!\\nIn order to arrive at the linq up point, please depart at the following time:\\n\";\r\n      text += leaveTimes[i] + \"\\n\";\r\n      text +=\r\n        \"The directions to your destination can be found using this link\\n\";\r\n      text +=\r\n        \"https://www.google.com/maps/dir/\" +\r\n        coords[i].lat +\r\n        \",\" +\r\n        coords[i].lng +\r\n        \"/\" +\r\n        meetupPoint.lat +\r\n        \",\" +\r\n        meetupPoint.lng +\r\n        \"/\";\r\n\r\n      email = emails[i];\r\n\r\n      content = { to: email, text: text };\r\n      Axios.post(\"http://localhost:4000/sendemail\", content);\r\n    }\r\n  };\r\n\r\n  linqupBtnChecker = () => {\r\n    let emails = this.state.emails;\r\n    const newStyle = { display: \"inline\" };\r\n    let valid = true;\r\n    const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n    //validating all emails before displaying linq up button to prevent email errors\r\n    for (let i = 0; i < emails.length; i++) {\r\n      if (!re.test(String(emails[i]).toLowerCase())) {\r\n        valid = false;\r\n      }\r\n    }\r\n\r\n    if (valid) {\r\n      this.setState({ linqupbtnStyle: newStyle });\r\n    }\r\n  };\r\n\r\n  showModal = () => {\r\n    this.setState({ modalVisibility: true });\r\n  };\r\n\r\n  hideModal = () => {\r\n    this.setState({ modalVisibility: false });\r\n  };\r\n\r\n  handleSetMeetName = (name) => {\r\n    this.setState({ meetupPointName: name });\r\n  };\r\n\r\n  render() {\r\n    let time = this.state.date;\r\n    let meetupPoint;\r\n\r\n    if (this.state.meetupPoint) {\r\n      if (this.state.meetupPointName !== \"\") {\r\n        meetupPoint = this.state.meetupPointName;\r\n      } else {\r\n        meetupPoint = [\r\n          this.state.meetupPoint.lat,\r\n          this.state.meetupPoint.lng,\r\n        ].toString();\r\n      }\r\n    }\r\n\r\n    return (\r\n      <div className=\"app\">\r\n        <div className=\"banner\">\r\n          <div className=\"jumbotron\">\r\n            <h1 className=\"display-3\">Linq up</h1>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"placepicker\">\r\n          <PlacePicker\r\n            onSetRadius={(e) => this.handleSetRadius(e)}\r\n            onSetPOI={(e) => this.handleSetPOI(e)}\r\n          ></PlacePicker>\r\n        </div>\r\n\r\n        <div className=\"directionspicker\">\r\n          <DirectionsPicker\r\n            onSetTransport={(e) => this.handleSetTransport(e)}\r\n            onSetDate={(date) => this.handleSetDate(date)}\r\n          ></DirectionsPicker>\r\n        </div>\r\n\r\n        <div className=\"personlist\">\r\n          <PersonList\r\n            people={this.state.people}\r\n            onAddPerson={() => this.handleAddPerson()}\r\n            onDeletePerson={() => this.handleDeletePerson()}\r\n          ></PersonList>\r\n        </div>\r\n\r\n        <div className=\"buttons\">\r\n          <div className=\"buttonholder\">\r\n            <button\r\n              className=\"btn btn-outline-secondary\"\r\n              onClick={this.calculator}\r\n            >\r\n              Calculate\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"buttonholder\">\r\n            <button\r\n              style={this.state.linqupbtnStyle}\r\n              className=\"btn btn-outline-dark\"\r\n              onClick={() => {\r\n                this.getTravelTimes();\r\n                this.showModal();\r\n              }}\r\n            >\r\n              Linq up!\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <Modal centered={true} isOpen={this.state.modalVisibility}>\r\n          <ModalHeader>Linq up Confirmation</ModalHeader>\r\n          <ModalBody>\r\n            <Alert color=\"warning\">Linq up Time: {time}</Alert>\r\n            <Alert color=\"warning\">Linq up Place: {meetupPoint}</Alert>\r\n          </ModalBody>\r\n          <ModalFooter>\r\n            <button className=\"btn btn-danger\" onClick={this.hideModal}>\r\n              Cancel\r\n            </button>\r\n            <button\r\n              className=\"btn btn-success\"\r\n              onClick={() => {\r\n                this.hideModal();\r\n                this.sendEmails();\r\n              }}\r\n            >\r\n              Proceed\r\n            </button>\r\n          </ModalFooter>\r\n        </Modal>\r\n\r\n        <div className=\"map\">\r\n          <p className=\"badge badge-secondary\">Press Ctrl+r if map did not load</p>\r\n          <MapContainer\r\n            circleLat={this.state.circleLat}\r\n            circleLng={this.state.circleLng}\r\n            POI={this.state.POI}\r\n            addresses={this.state.addresses}\r\n            currentLocation={this.state.currentLocation}\r\n            coords={this.state.coords}\r\n            midpoint={this.state.midPoint}\r\n            radius={this.state.radius}\r\n            nearbyPlaces={this.state.nearbyPlaces}\r\n            onSetMeetupPoint={(loc) => this.handleSetMeetupPoint(loc)}\r\n            onSetMeetName={(name) => this.handleSetMeetName(name)}\r\n          ></MapContainer>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Application;\r\n"]},"metadata":{},"sourceType":"module"}